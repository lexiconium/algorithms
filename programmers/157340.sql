WITH RENTAL_STATUS AS (
    SELECT
        CAR_ID,
        CASE
            WHEN '2022-10-16' BETWEEN START_DATE AND END_DATE THEN 0
            ELSE 1
        END AVAILABILITY
    FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
)
SELECT
    CAR_ID,
    IF(MIN(AVAILABILITY) = 0, '대여중', '대여 가능') AVAILABILITY
FROM RENTAL_STATUS
GROUP BY CAR_ID
ORDER BY CAR_ID DESC;
